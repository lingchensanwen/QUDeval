### This is the script to automatic evaluate criteria 3 (Giveness)

### before running you may wanna set your openai keys for gpt-base 

### label 1 - No new concept, label 2 - Answer leakage, label3 - Hallucination
### Directory structure

example_article.txt - example article, please replace this with articles you wanna run eval on

example_anchor_answer_info.csv - example article anchor and answer information, please replace it with the one generated by your qud paser

Rule base scripts (I have two approches here, the best one in paper is content-base): 
### [for rule base](https://github.com/lingchensanwen/QUDeval/tree/main/code/criteria3_giveness/rule-base)

#### content base
<code>!python rule-base.py --rule="content-based" --strict=False</code> and genearte a file
ended with "_content-based_strict_*.txt"
  - strict can be True/ False

#### np base

<code>!python longest_np.py</code> will get longest np and its head for next step and generate a file ended with "_with_np.csv"

then run
<code>!python rule-base.py --rule="np-based" --strict=False</code> and genearte a file
ended with "_NP-based_strict_*.txt"
  - strict can be True/ False

### [for gpt base](https://github.com/lingchensanwen/QUDeval/tree/main/code/criteria3_giveness/gpt-base)
<code>!python gpt_response</code> will get gpt response for both zero-shot and few-shot evaluation using gpt, in this repo example we use gpt-3.5-turbo


### [for Hou-2021 base](https://github.com/lingchensanwen/QUDeval/tree/main/code/criteria3_giveness/Entity-classify)
We cloned [Hou-2021 repo](https://github.com/IBM/bridging-resolution/tree/master) and we're mainly using End2endISPrediction here to classify entity.
We modify on this code so we have labels for ["old_np", "new_np", "mediated"] only. Also you need to ask Yufang (bnuxiaofang@gmail.com) to get the trained mention extraction model. (We'll contact her as well to see if she can post it publicly). 
Before run on her code, you may also wanna process your file, 

1. run <code>!python longest_np.py</code> to get longest np 
2. run <code>!python format_input.py</code> to format your article ready for classify

Then please follow Hou's instruction to run the code under this sub-repo and classify it to ["old_np", "new_np", "mediated"]
then you should be able to get a [txt file like this example](https://github.com/lingchensanwen/QUDeval/blob/main/code/criteria3_giveness/Entity-classify/bridging-resolution/End2endISPrediction/preprocess/example_entity.txt) and the 2nd column is your predict result for those three labels 0 - old_np, 1 - new_np, 2 - mediated

(Before run 3, you need to check above run rule-base to get a rule base reference as we need to differentiate new_np into different cases)

3. run <code>!python post_predict.py</code> to futher convert those three labels to ["No new concept", "Answer leakage", "Hallucination"]
